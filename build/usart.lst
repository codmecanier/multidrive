ARM GAS  /tmp/ccX5FeAK.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"usart.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text._sys_exit,"ax",%progbits
  18              		.align	1
  19              		.global	_sys_exit
  20              		.arch armv7e-m
  21              		.syntax unified
  22              		.thumb
  23              		.thumb_func
  24              		.fpu fpv4-sp-d16
  26              	_sys_exit:
  27              	.LVL0:
  28              	.LFB135:
  29              		.file 1 "SYSTEM/usart/usart.c"
   1:SYSTEM/usart/usart.c **** #include "usart.h"
   2:SYSTEM/usart/usart.c **** #include "delay.h"
   3:SYSTEM/usart/usart.c **** ////////////////////////////////////////////////////////////////////////////////// 	 
   4:SYSTEM/usart/usart.c **** //å¦‚æžœä½¿ç”¨os,åˆ™åŒ…æ‹¬ä¸‹é¢çš„å¤´æ–‡ä»¶å³å¯.
   5:SYSTEM/usart/usart.c **** #if SYSTEM_SUPPORT_OS
   6:SYSTEM/usart/usart.c **** #include "includes.h"					//os ä½¿ç”¨	  
   7:SYSTEM/usart/usart.c **** #endif
   8:SYSTEM/usart/usart.c **** //////////////////////////////////////////////////////////////////////////////////	 
   9:SYSTEM/usart/usart.c **** //æœ¬ç¨‹åºåªä¾›å­¦ä¹ ä½¿ç”¨ï¼Œæœªç»ä½œè€…è®¸å¯ï¼Œä¸å¾—ç”¨äºŽå…¶å®ƒä»»ä½•ç”¨é€”
  10:SYSTEM/usart/usart.c **** //ALIENTEK STM32F407å¼€å‘æ¿
  11:SYSTEM/usart/usart.c **** //ä¸²å£1åˆå§‹åŒ–		   
  12:SYSTEM/usart/usart.c **** //æ­£ç‚¹åŽŸå­@ALIENTEK
  13:SYSTEM/usart/usart.c **** //æŠ€æœ¯è®ºå›:www.openedv.com
  14:SYSTEM/usart/usart.c **** //ä¿®æ”¹æ—¥æœŸ:2017/4/6
  15:SYSTEM/usart/usart.c **** //ç‰ˆæœ¬ï¼šV1.5
  16:SYSTEM/usart/usart.c **** //ç‰ˆæƒæ‰€æœ‰ï¼Œç›—ç‰ˆå¿…ç©¶ã€‚
  17:SYSTEM/usart/usart.c **** //Copyright(C) å¹¿å·žå¸‚æ˜Ÿç¿¼ç”µå­ç§‘æŠ€æœ‰é™å…¬å¸ 2009-2019
  18:SYSTEM/usart/usart.c **** //All rights reserved
  19:SYSTEM/usart/usart.c **** //********************************************************************************
  20:SYSTEM/usart/usart.c **** //V1.0ä¿®æ”¹è¯´æ˜Ž 
  21:SYSTEM/usart/usart.c **** ////////////////////////////////////////////////////////////////////////////////// 	  
  22:SYSTEM/usart/usart.c **** //åŠ å…¥ä»¥ä¸‹ä»£ç ,æ”¯æŒprintfå‡½æ•°,è€Œä¸éœ€è¦é€‰æ‹©use MicroLIB	  
  23:SYSTEM/usart/usart.c **** //#define PUTCHAR_PROTOTYPE int fputc(int ch, FILE *f)	
  24:SYSTEM/usart/usart.c **** #if 1
  25:SYSTEM/usart/usart.c **** #pragma import(__use_no_semihosting)             
  26:SYSTEM/usart/usart.c **** //æ ‡å‡†åº“éœ€è¦çš„æ”¯æŒå‡½æ•°                 
  27:SYSTEM/usart/usart.c **** struct __FILE 
  28:SYSTEM/usart/usart.c **** { 
  29:SYSTEM/usart/usart.c **** 	int handle; 
ARM GAS  /tmp/ccX5FeAK.s 			page 2


  30:SYSTEM/usart/usart.c **** }; 
  31:SYSTEM/usart/usart.c **** 
  32:SYSTEM/usart/usart.c **** FILE __stdout;       
  33:SYSTEM/usart/usart.c **** //å®šä¹‰_sys_exit()ä»¥é¿å…ä½¿ç”¨åŠä¸»æœºæ¨¡å¼    
  34:SYSTEM/usart/usart.c **** void _sys_exit(int x) 
  35:SYSTEM/usart/usart.c **** { 
  30              		.loc 1 35 1 view -0
  31              		.cfi_startproc
  32              		@ args = 0, pretend = 0, frame = 0
  33              		@ frame_needed = 0, uses_anonymous_args = 0
  34              		@ link register save eliminated.
  36:SYSTEM/usart/usart.c **** 	x = x; 
  35              		.loc 1 36 2 view .LVU1
  37:SYSTEM/usart/usart.c **** } 
  36              		.loc 1 37 1 is_stmt 0 view .LVU2
  37 0000 7047     		bx	lr
  38              		.cfi_endproc
  39              	.LFE135:
  41              		.section	.text.fputc,"ax",%progbits
  42              		.align	1
  43              		.global	fputc
  44              		.syntax unified
  45              		.thumb
  46              		.thumb_func
  47              		.fpu fpv4-sp-d16
  49              	fputc:
  50              	.LFB136:
  38:SYSTEM/usart/usart.c **** //é‡å®šä¹‰fputcå‡½æ•° 
  39:SYSTEM/usart/usart.c **** int fputc(int ch, FILE *f)
  40:SYSTEM/usart/usart.c **** { 	
  51              		.loc 1 40 1 is_stmt 1 view -0
  52              		.cfi_startproc
  53              		@ args = 0, pretend = 0, frame = 0
  54              		@ frame_needed = 0, uses_anonymous_args = 0
  55              		@ link register save eliminated.
  56              	.LVL1:
  57              	.L3:
  41:SYSTEM/usart/usart.c **** 	while((USART1->SR&0X40)==0);//å¾ªçŽ¯å‘é€,ç›´åˆ°å‘é€å®Œæ¯•   
  58              		.loc 1 41 29 discriminator 1 view .LVU4
  59              		.loc 1 41 7 discriminator 1 view .LVU5
  60              		.loc 1 41 15 is_stmt 0 discriminator 1 view .LVU6
  61 0000 044B     		ldr	r3, .L4
  62 0002 1B68     		ldr	r3, [r3]
  63              		.loc 1 41 7 discriminator 1 view .LVU7
  64 0004 13F0400F 		tst	r3, #64
  65 0008 FAD0     		beq	.L3
  42:SYSTEM/usart/usart.c **** 	USART1->DR = (u8) ch;      
  66              		.loc 1 42 2 is_stmt 1 view .LVU8
  67              		.loc 1 42 15 is_stmt 0 view .LVU9
  68 000a C2B2     		uxtb	r2, r0
  69              		.loc 1 42 13 view .LVU10
  70 000c 014B     		ldr	r3, .L4
  71 000e 5A60     		str	r2, [r3, #4]
  43:SYSTEM/usart/usart.c **** 	return ch;
  72              		.loc 1 43 2 is_stmt 1 view .LVU11
  44:SYSTEM/usart/usart.c **** }
  73              		.loc 1 44 1 is_stmt 0 view .LVU12
ARM GAS  /tmp/ccX5FeAK.s 			page 3


  74 0010 7047     		bx	lr
  75              	.L5:
  76 0012 00BF     		.align	2
  77              	.L4:
  78 0014 00100140 		.word	1073811456
  79              		.cfi_endproc
  80              	.LFE136:
  82              		.section	.text.uart_init,"ax",%progbits
  83              		.align	1
  84              		.global	uart_init
  85              		.syntax unified
  86              		.thumb
  87              		.thumb_func
  88              		.fpu fpv4-sp-d16
  90              	uart_init:
  91              	.LVL2:
  92              	.LFB137:
  45:SYSTEM/usart/usart.c **** #endif 
  46:SYSTEM/usart/usart.c **** 
  47:SYSTEM/usart/usart.c **** #if EN_USART1_RX   //å¦‚æžœä½¿èƒ½äº†æŽ¥æ”¶
  48:SYSTEM/usart/usart.c **** //ä¸²å£1ä¸­æ–­æœåŠ¡ç¨‹åº
  49:SYSTEM/usart/usart.c **** //æ³¨æ„,è¯»å–USARTx->SRèƒ½é¿å…èŽ«åå…¶å¦™çš„é”™è¯¯   	
  50:SYSTEM/usart/usart.c **** u8 USART_RX_BUF[USART_REC_LEN];     //æŽ¥æ”¶ç¼“å†²,æœ€å¤§USART_REC_LENä¸ªå­—èŠ‚.
  51:SYSTEM/usart/usart.c **** //æŽ¥æ”¶çŠ¶æ€
  52:SYSTEM/usart/usart.c **** //bit15ï¼Œ	æŽ¥æ”¶å®Œæˆæ ‡å¿—
  53:SYSTEM/usart/usart.c **** //bit14ï¼Œ	æŽ¥æ”¶åˆ°0x0d
  54:SYSTEM/usart/usart.c **** //bit13~0ï¼Œ	æŽ¥æ”¶åˆ°çš„æœ‰æ•ˆå­—èŠ‚æ•°ç›®
  55:SYSTEM/usart/usart.c **** u16 USART_RX_STA=0;       //æŽ¥æ”¶çŠ¶æ€æ ‡è®°	
  56:SYSTEM/usart/usart.c **** 
  57:SYSTEM/usart/usart.c **** u8 aRxBuffer[RXBUFFERSIZE];//HALåº“ä½¿ç”¨çš„ä¸²å£æŽ¥æ”¶ç¼“å†²
  58:SYSTEM/usart/usart.c **** UART_HandleTypeDef UART1_Handler; //UARTå¥æŸ„
  59:SYSTEM/usart/usart.c **** 
  60:SYSTEM/usart/usart.c **** //åˆå§‹åŒ–IO ä¸²å£1 
  61:SYSTEM/usart/usart.c **** //bound:æ³¢ç‰¹çŽ‡
  62:SYSTEM/usart/usart.c **** void uart_init(u32 bound)
  63:SYSTEM/usart/usart.c **** {	
  93              		.loc 1 63 1 is_stmt 1 view -0
  94              		.cfi_startproc
  95              		@ args = 0, pretend = 0, frame = 0
  96              		@ frame_needed = 0, uses_anonymous_args = 0
  97              		.loc 1 63 1 is_stmt 0 view .LVU14
  98 0000 10B5     		push	{r4, lr}
  99              	.LCFI0:
 100              		.cfi_def_cfa_offset 8
 101              		.cfi_offset 4, -8
 102              		.cfi_offset 14, -4
  64:SYSTEM/usart/usart.c **** 	//UART åˆå§‹åŒ–è®¾ç½®
  65:SYSTEM/usart/usart.c **** 	UART1_Handler.Instance=USART1;					    //USART1
 103              		.loc 1 65 2 is_stmt 1 view .LVU15
 104              		.loc 1 65 24 is_stmt 0 view .LVU16
 105 0002 0A4C     		ldr	r4, .L8
 106 0004 0A4B     		ldr	r3, .L8+4
 107 0006 2360     		str	r3, [r4]
  66:SYSTEM/usart/usart.c **** 	UART1_Handler.Init.BaudRate=bound;				    //æ³¢ç‰¹çŽ‡
 108              		.loc 1 66 2 is_stmt 1 view .LVU17
 109              		.loc 1 66 29 is_stmt 0 view .LVU18
 110 0008 6060     		str	r0, [r4, #4]
ARM GAS  /tmp/ccX5FeAK.s 			page 4


  67:SYSTEM/usart/usart.c **** 	UART1_Handler.Init.WordLength=UART_WORDLENGTH_8B;   //å­—é•¿ä¸º8ä½æ•°æ®æ ¼å¼
 111              		.loc 1 67 2 is_stmt 1 view .LVU19
 112              		.loc 1 67 31 is_stmt 0 view .LVU20
 113 000a 0023     		movs	r3, #0
 114 000c A360     		str	r3, [r4, #8]
  68:SYSTEM/usart/usart.c **** 	UART1_Handler.Init.StopBits=UART_STOPBITS_1;	    //ä¸€ä¸ªåœæ­¢ä½
 115              		.loc 1 68 2 is_stmt 1 view .LVU21
 116              		.loc 1 68 29 is_stmt 0 view .LVU22
 117 000e E360     		str	r3, [r4, #12]
  69:SYSTEM/usart/usart.c **** 	UART1_Handler.Init.Parity=UART_PARITY_NONE;		    //æ— å¥‡å¶æ ¡éªŒä½
 118              		.loc 1 69 2 is_stmt 1 view .LVU23
 119              		.loc 1 69 27 is_stmt 0 view .LVU24
 120 0010 2361     		str	r3, [r4, #16]
  70:SYSTEM/usart/usart.c **** 	UART1_Handler.Init.HwFlowCtl=UART_HWCONTROL_NONE;   //æ— ç¡¬ä»¶æµæŽ§
 121              		.loc 1 70 2 is_stmt 1 view .LVU25
 122              		.loc 1 70 30 is_stmt 0 view .LVU26
 123 0012 A361     		str	r3, [r4, #24]
  71:SYSTEM/usart/usart.c **** 	UART1_Handler.Init.Mode=UART_MODE_TX_RX;		    //æ”¶å‘æ¨¡å¼
 124              		.loc 1 71 2 is_stmt 1 view .LVU27
 125              		.loc 1 71 25 is_stmt 0 view .LVU28
 126 0014 0C23     		movs	r3, #12
 127 0016 6361     		str	r3, [r4, #20]
  72:SYSTEM/usart/usart.c **** 	HAL_UART_Init(&UART1_Handler);					    //HAL_UART_Init()ä¼šä½¿èƒ½UART1
 128              		.loc 1 72 2 is_stmt 1 view .LVU29
 129 0018 2046     		mov	r0, r4
 130              	.LVL3:
 131              		.loc 1 72 2 is_stmt 0 view .LVU30
 132 001a FFF7FEFF 		bl	HAL_UART_Init
 133              	.LVL4:
  73:SYSTEM/usart/usart.c **** 	
  74:SYSTEM/usart/usart.c **** 	HAL_UART_Receive_IT(&UART1_Handler, (u8 *)aRxBuffer, RXBUFFERSIZE);//è¯¥å‡½æ•°ä¼šå¼€å¯æŽ¥æ”¶ä¸­æ–
 134              		.loc 1 74 2 is_stmt 1 view .LVU31
 135 001e 0122     		movs	r2, #1
 136 0020 0449     		ldr	r1, .L8+8
 137 0022 2046     		mov	r0, r4
 138 0024 FFF7FEFF 		bl	HAL_UART_Receive_IT
 139              	.LVL5:
  75:SYSTEM/usart/usart.c ****   
  76:SYSTEM/usart/usart.c **** }
 140              		.loc 1 76 1 is_stmt 0 view .LVU32
 141 0028 10BD     		pop	{r4, pc}
 142              	.L9:
 143 002a 00BF     		.align	2
 144              	.L8:
 145 002c 00000000 		.word	UART1_Handler
 146 0030 00100140 		.word	1073811456
 147 0034 00000000 		.word	aRxBuffer
 148              		.cfi_endproc
 149              	.LFE137:
 151              		.section	.text.HAL_UART_MspInit,"ax",%progbits
 152              		.align	1
 153              		.global	HAL_UART_MspInit
 154              		.syntax unified
 155              		.thumb
 156              		.thumb_func
 157              		.fpu fpv4-sp-d16
 159              	HAL_UART_MspInit:
ARM GAS  /tmp/ccX5FeAK.s 			page 5


 160              	.LVL6:
 161              	.LFB138:
  77:SYSTEM/usart/usart.c **** 
  78:SYSTEM/usart/usart.c **** //UARTåº•å±‚åˆå§‹åŒ–ï¼Œæ—¶é’Ÿä½¿èƒ½ï¼Œå¼•è„šé…ç½®ï¼Œä¸­æ–­é…ç½®
  79:SYSTEM/usart/usart.c **** //æ­¤å‡½æ•°ä¼šè¢«HAL_UART_Init()è°ƒç”¨
  80:SYSTEM/usart/usart.c **** //huart:ä¸²å£å¥æŸ„
  81:SYSTEM/usart/usart.c **** 
  82:SYSTEM/usart/usart.c **** void HAL_UART_MspInit(UART_HandleTypeDef *huart)
  83:SYSTEM/usart/usart.c **** {
 162              		.loc 1 83 1 is_stmt 1 view -0
 163              		.cfi_startproc
 164              		@ args = 0, pretend = 0, frame = 32
 165              		@ frame_needed = 0, uses_anonymous_args = 0
  84:SYSTEM/usart/usart.c ****     //GPIOç«¯å£è®¾ç½®
  85:SYSTEM/usart/usart.c **** 	GPIO_InitTypeDef GPIO_Initure;
 166              		.loc 1 85 2 view .LVU34
  86:SYSTEM/usart/usart.c **** 	
  87:SYSTEM/usart/usart.c **** 	if(huart->Instance==USART1)//å¦‚æžœæ˜¯ä¸²å£1ï¼Œè¿›è¡Œä¸²å£1 MSPåˆå§‹åŒ–
 167              		.loc 1 87 2 view .LVU35
 168              		.loc 1 87 10 is_stmt 0 view .LVU36
 169 0000 0268     		ldr	r2, [r0]
 170              		.loc 1 87 4 view .LVU37
 171 0002 1E4B     		ldr	r3, .L17
 172 0004 9A42     		cmp	r2, r3
 173 0006 00D0     		beq	.L16
 174 0008 7047     		bx	lr
 175              	.L16:
  83:SYSTEM/usart/usart.c ****     //GPIOç«¯å£è®¾ç½®
 176              		.loc 1 83 1 view .LVU38
 177 000a 10B5     		push	{r4, lr}
 178              	.LCFI1:
 179              		.cfi_def_cfa_offset 8
 180              		.cfi_offset 4, -8
 181              		.cfi_offset 14, -4
 182 000c 88B0     		sub	sp, sp, #32
 183              	.LCFI2:
 184              		.cfi_def_cfa_offset 40
  88:SYSTEM/usart/usart.c **** 	{
  89:SYSTEM/usart/usart.c **** 		__HAL_RCC_GPIOA_CLK_ENABLE();			//ä½¿èƒ½GPIOAæ—¶é’Ÿ
 185              		.loc 1 89 3 is_stmt 1 view .LVU39
 186              	.LBB2:
 187              		.loc 1 89 3 view .LVU40
 188 000e 0021     		movs	r1, #0
 189 0010 0191     		str	r1, [sp, #4]
 190              		.loc 1 89 3 view .LVU41
 191 0012 03F59433 		add	r3, r3, #75776
 192 0016 1A6B     		ldr	r2, [r3, #48]
 193 0018 42F00102 		orr	r2, r2, #1
 194 001c 1A63     		str	r2, [r3, #48]
 195              		.loc 1 89 3 view .LVU42
 196 001e 1A6B     		ldr	r2, [r3, #48]
 197 0020 02F00102 		and	r2, r2, #1
 198 0024 0192     		str	r2, [sp, #4]
 199              		.loc 1 89 3 view .LVU43
 200 0026 019A     		ldr	r2, [sp, #4]
 201              	.LBE2:
 202              		.loc 1 89 3 view .LVU44
ARM GAS  /tmp/ccX5FeAK.s 			page 6


  90:SYSTEM/usart/usart.c **** 		__HAL_RCC_USART1_CLK_ENABLE();			//ä½¿èƒ½USART1æ—¶é’Ÿ
 203              		.loc 1 90 3 view .LVU45
 204              	.LBB3:
 205              		.loc 1 90 3 view .LVU46
 206 0028 0291     		str	r1, [sp, #8]
 207              		.loc 1 90 3 view .LVU47
 208 002a 5A6C     		ldr	r2, [r3, #68]
 209 002c 42F01002 		orr	r2, r2, #16
 210 0030 5A64     		str	r2, [r3, #68]
 211              		.loc 1 90 3 view .LVU48
 212 0032 5B6C     		ldr	r3, [r3, #68]
 213 0034 03F01003 		and	r3, r3, #16
 214 0038 0293     		str	r3, [sp, #8]
 215              		.loc 1 90 3 view .LVU49
 216 003a 029B     		ldr	r3, [sp, #8]
 217              	.LBE3:
 218              		.loc 1 90 3 view .LVU50
  91:SYSTEM/usart/usart.c **** 	
  92:SYSTEM/usart/usart.c **** 		GPIO_Initure.Pin=GPIO_PIN_9;			//PA9
 219              		.loc 1 92 3 view .LVU51
 220              		.loc 1 92 19 is_stmt 0 view .LVU52
 221 003c 4FF40073 		mov	r3, #512
 222 0040 0393     		str	r3, [sp, #12]
  93:SYSTEM/usart/usart.c **** 		GPIO_Initure.Mode=GPIO_MODE_AF_PP;		//å¤ç”¨æŽ¨æŒ½è¾“å‡º
 223              		.loc 1 93 3 is_stmt 1 view .LVU53
 224              		.loc 1 93 20 is_stmt 0 view .LVU54
 225 0042 0223     		movs	r3, #2
 226 0044 0493     		str	r3, [sp, #16]
  94:SYSTEM/usart/usart.c **** 		GPIO_Initure.Pull=GPIO_PULLUP;			//ä¸Šæ‹‰
 227              		.loc 1 94 3 is_stmt 1 view .LVU55
 228              		.loc 1 94 20 is_stmt 0 view .LVU56
 229 0046 0122     		movs	r2, #1
 230 0048 0592     		str	r2, [sp, #20]
  95:SYSTEM/usart/usart.c **** 		GPIO_Initure.Speed=GPIO_SPEED_FAST;		//é«˜é€Ÿ
 231              		.loc 1 95 3 is_stmt 1 view .LVU57
 232              		.loc 1 95 21 is_stmt 0 view .LVU58
 233 004a 0693     		str	r3, [sp, #24]
  96:SYSTEM/usart/usart.c **** 		GPIO_Initure.Alternate=GPIO_AF7_USART1;	//å¤ç”¨ä¸ºUSART1
 234              		.loc 1 96 3 is_stmt 1 view .LVU59
 235              		.loc 1 96 25 is_stmt 0 view .LVU60
 236 004c 0723     		movs	r3, #7
 237 004e 0793     		str	r3, [sp, #28]
  97:SYSTEM/usart/usart.c **** 		HAL_GPIO_Init(GPIOA,&GPIO_Initure);	   	//åˆå§‹åŒ–PA9
 238              		.loc 1 97 3 is_stmt 1 view .LVU61
 239 0050 0B4C     		ldr	r4, .L17+4
 240 0052 03A9     		add	r1, sp, #12
 241 0054 2046     		mov	r0, r4
 242              	.LVL7:
 243              		.loc 1 97 3 is_stmt 0 view .LVU62
 244 0056 FFF7FEFF 		bl	HAL_GPIO_Init
 245              	.LVL8:
  98:SYSTEM/usart/usart.c **** 
  99:SYSTEM/usart/usart.c **** 		GPIO_Initure.Pin=GPIO_PIN_10;			//PA10
 246              		.loc 1 99 3 is_stmt 1 view .LVU63
 247              		.loc 1 99 19 is_stmt 0 view .LVU64
 248 005a 4FF48063 		mov	r3, #1024
 249 005e 0393     		str	r3, [sp, #12]
ARM GAS  /tmp/ccX5FeAK.s 			page 7


 100:SYSTEM/usart/usart.c **** 		HAL_GPIO_Init(GPIOA,&GPIO_Initure);	   	//åˆå§‹åŒ–PA10
 250              		.loc 1 100 3 is_stmt 1 view .LVU65
 251 0060 03A9     		add	r1, sp, #12
 252 0062 2046     		mov	r0, r4
 253 0064 FFF7FEFF 		bl	HAL_GPIO_Init
 254              	.LVL9:
 101:SYSTEM/usart/usart.c **** 		
 102:SYSTEM/usart/usart.c **** #if EN_USART1_RX
 103:SYSTEM/usart/usart.c **** 		HAL_NVIC_EnableIRQ(USART1_IRQn);				//ä½¿èƒ½USART1ä¸­æ–­é€šé“
 255              		.loc 1 103 3 view .LVU66
 256 0068 2520     		movs	r0, #37
 257 006a FFF7FEFF 		bl	HAL_NVIC_EnableIRQ
 258              	.LVL10:
 104:SYSTEM/usart/usart.c **** 		HAL_NVIC_SetPriority(USART1_IRQn,3,3);			//æŠ¢å ä¼˜å…ˆçº§3ï¼Œå­ä¼˜å…ˆçº§3
 259              		.loc 1 104 3 view .LVU67
 260 006e 0322     		movs	r2, #3
 261 0070 1146     		mov	r1, r2
 262 0072 2520     		movs	r0, #37
 263 0074 FFF7FEFF 		bl	HAL_NVIC_SetPriority
 264              	.LVL11:
 105:SYSTEM/usart/usart.c **** #endif	
 106:SYSTEM/usart/usart.c **** 	}
 107:SYSTEM/usart/usart.c **** 
 108:SYSTEM/usart/usart.c **** }
 265              		.loc 1 108 1 is_stmt 0 view .LVU68
 266 0078 08B0     		add	sp, sp, #32
 267              	.LCFI3:
 268              		.cfi_def_cfa_offset 8
 269              		@ sp needed
 270 007a 10BD     		pop	{r4, pc}
 271              	.L18:
 272              		.align	2
 273              	.L17:
 274 007c 00100140 		.word	1073811456
 275 0080 00000240 		.word	1073872896
 276              		.cfi_endproc
 277              	.LFE138:
 279              		.section	.text.HAL_UART_RxCpltCallback,"ax",%progbits
 280              		.align	1
 281              		.global	HAL_UART_RxCpltCallback
 282              		.syntax unified
 283              		.thumb
 284              		.thumb_func
 285              		.fpu fpv4-sp-d16
 287              	HAL_UART_RxCpltCallback:
 288              	.LVL12:
 289              	.LFB139:
 109:SYSTEM/usart/usart.c **** 
 110:SYSTEM/usart/usart.c **** void HAL_UART_RxCpltCallback(UART_HandleTypeDef *huart)
 111:SYSTEM/usart/usart.c **** {
 290              		.loc 1 111 1 is_stmt 1 view -0
 291              		.cfi_startproc
 292              		@ args = 0, pretend = 0, frame = 0
 293              		@ frame_needed = 0, uses_anonymous_args = 0
 294              		@ link register save eliminated.
 112:SYSTEM/usart/usart.c **** 	if(huart->Instance==USART1)//å¦‚æžœæ˜¯ä¸²å£1
 295              		.loc 1 112 2 view .LVU70
ARM GAS  /tmp/ccX5FeAK.s 			page 8


 296              		.loc 1 112 10 is_stmt 0 view .LVU71
 297 0000 0268     		ldr	r2, [r0]
 298              		.loc 1 112 4 view .LVU72
 299 0002 194B     		ldr	r3, .L26
 300 0004 9A42     		cmp	r2, r3
 301 0006 00D0     		beq	.L24
 302              	.LVL13:
 303              	.L19:
 113:SYSTEM/usart/usart.c **** 	{
 114:SYSTEM/usart/usart.c **** 		if((USART_RX_STA&0x8000)==0)//æŽ¥æ”¶æœªå®Œæˆ
 115:SYSTEM/usart/usart.c **** 		{
 116:SYSTEM/usart/usart.c **** 			if(USART_RX_STA&0x4000)//æŽ¥æ”¶åˆ°äº†0x0d
 117:SYSTEM/usart/usart.c **** 			{
 118:SYSTEM/usart/usart.c **** 				if(aRxBuffer[0]!=0x0a)USART_RX_STA=0;//æŽ¥æ”¶é”™è¯¯,é‡æ–°å¼€å§‹
 119:SYSTEM/usart/usart.c **** 				else USART_RX_STA|=0x8000;	//æŽ¥æ”¶å®Œæˆäº† 
 120:SYSTEM/usart/usart.c **** 			}
 121:SYSTEM/usart/usart.c **** 			else //è¿˜æ²¡æ”¶åˆ°0X0D
 122:SYSTEM/usart/usart.c **** 			{	
 123:SYSTEM/usart/usart.c **** 				if(aRxBuffer[0]==0x0d)USART_RX_STA|=0x4000;
 124:SYSTEM/usart/usart.c **** 				else
 125:SYSTEM/usart/usart.c **** 				{
 126:SYSTEM/usart/usart.c **** 					USART_RX_BUF[USART_RX_STA&0X3FFF]=aRxBuffer[0] ;
 127:SYSTEM/usart/usart.c **** 					USART_RX_STA++;
 128:SYSTEM/usart/usart.c **** 					if(USART_RX_STA>(USART_REC_LEN-1))USART_RX_STA=0;//æŽ¥æ”¶æ•°æ®é”™è¯¯,é‡æ–°å¼€å§‹æŽ¥æ”¶	  
 129:SYSTEM/usart/usart.c **** 				}		 
 130:SYSTEM/usart/usart.c **** 			}
 131:SYSTEM/usart/usart.c **** 		}
 132:SYSTEM/usart/usart.c **** 
 133:SYSTEM/usart/usart.c **** 	}
 134:SYSTEM/usart/usart.c **** }
 304              		.loc 1 134 1 view .LVU73
 305 0008 7047     		bx	lr
 306              	.LVL14:
 307              	.L24:
 114:SYSTEM/usart/usart.c **** 		{
 308              		.loc 1 114 3 is_stmt 1 view .LVU74
 114:SYSTEM/usart/usart.c **** 		{
 309              		.loc 1 114 27 is_stmt 0 view .LVU75
 310 000a 184A     		ldr	r2, .L26+4
 311 000c 1388     		ldrh	r3, [r2]
 312 000e B2F90020 		ldrsh	r2, [r2]
 114:SYSTEM/usart/usart.c **** 		{
 313              		.loc 1 114 5 view .LVU76
 314 0012 002A     		cmp	r2, #0
 315 0014 F8DB     		blt	.L19
 116:SYSTEM/usart/usart.c **** 			{
 316              		.loc 1 116 4 is_stmt 1 view .LVU77
 116:SYSTEM/usart/usart.c **** 			{
 317              		.loc 1 116 6 is_stmt 0 view .LVU78
 318 0016 13F4804F 		tst	r3, #16384
 319 001a 0ED0     		beq	.L21
 118:SYSTEM/usart/usart.c **** 				else USART_RX_STA|=0x8000;	//æŽ¥æ”¶å®Œæˆäº† 
 320              		.loc 1 118 5 is_stmt 1 view .LVU79
 118:SYSTEM/usart/usart.c **** 				else USART_RX_STA|=0x8000;	//æŽ¥æ”¶å®Œæˆäº† 
 321              		.loc 1 118 17 is_stmt 0 view .LVU80
 322 001c 144A     		ldr	r2, .L26+8
 323 001e 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
ARM GAS  /tmp/ccX5FeAK.s 			page 9


 118:SYSTEM/usart/usart.c **** 				else USART_RX_STA|=0x8000;	//æŽ¥æ”¶å®Œæˆäº† 
 324              		.loc 1 118 7 view .LVU81
 325 0020 0A2A     		cmp	r2, #10
 326 0022 03D0     		beq	.L22
 118:SYSTEM/usart/usart.c **** 				else USART_RX_STA|=0x8000;	//æŽ¥æ”¶å®Œæˆäº† 
 327              		.loc 1 118 27 is_stmt 1 discriminator 1 view .LVU82
 118:SYSTEM/usart/usart.c **** 				else USART_RX_STA|=0x8000;	//æŽ¥æ”¶å®Œæˆäº† 
 328              		.loc 1 118 39 is_stmt 0 discriminator 1 view .LVU83
 329 0024 114B     		ldr	r3, .L26+4
 330 0026 0022     		movs	r2, #0
 331 0028 1A80     		strh	r2, [r3]	@ movhi
 332 002a 7047     		bx	lr
 333              	.L22:
 119:SYSTEM/usart/usart.c **** 			}
 334              		.loc 1 119 10 is_stmt 1 view .LVU84
 119:SYSTEM/usart/usart.c **** 			}
 335              		.loc 1 119 22 is_stmt 0 view .LVU85
 336 002c 6FEA4343 		mvn	r3, r3, lsl #17
 337 0030 6FEA5343 		mvn	r3, r3, lsr #17
 338 0034 0D4A     		ldr	r2, .L26+4
 339 0036 1380     		strh	r3, [r2]	@ movhi
 340 0038 7047     		bx	lr
 341              	.L21:
 123:SYSTEM/usart/usart.c **** 				else
 342              		.loc 1 123 5 is_stmt 1 view .LVU86
 123:SYSTEM/usart/usart.c **** 				else
 343              		.loc 1 123 17 is_stmt 0 view .LVU87
 344 003a 0D4A     		ldr	r2, .L26+8
 345 003c 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 123:SYSTEM/usart/usart.c **** 				else
 346              		.loc 1 123 7 view .LVU88
 347 003e 0D2A     		cmp	r2, #13
 348 0040 0DD0     		beq	.L25
 126:SYSTEM/usart/usart.c **** 					USART_RX_STA++;
 349              		.loc 1 126 6 is_stmt 1 view .LVU89
 126:SYSTEM/usart/usart.c **** 					USART_RX_STA++;
 350              		.loc 1 126 31 is_stmt 0 view .LVU90
 351 0042 C3F30D01 		ubfx	r1, r3, #0, #14
 126:SYSTEM/usart/usart.c **** 					USART_RX_STA++;
 352              		.loc 1 126 39 view .LVU91
 353 0046 0B48     		ldr	r0, .L26+12
 354              	.LVL15:
 126:SYSTEM/usart/usart.c **** 					USART_RX_STA++;
 355              		.loc 1 126 39 view .LVU92
 356 0048 4254     		strb	r2, [r0, r1]
 127:SYSTEM/usart/usart.c **** 					if(USART_RX_STA>(USART_REC_LEN-1))USART_RX_STA=0;//æŽ¥æ”¶æ•°æ®é”™è¯¯,é‡æ–°å¼€å§‹æŽ¥æ”¶	  
 357              		.loc 1 127 6 is_stmt 1 view .LVU93
 127:SYSTEM/usart/usart.c **** 					if(USART_RX_STA>(USART_REC_LEN-1))USART_RX_STA=0;//æŽ¥æ”¶æ•°æ®é”™è¯¯,é‡æ–°å¼€å§‹æŽ¥æ”¶	  
 358              		.loc 1 127 18 is_stmt 0 view .LVU94
 359 004a 0133     		adds	r3, r3, #1
 360 004c 9BB2     		uxth	r3, r3
 361 004e 074A     		ldr	r2, .L26+4
 362 0050 1380     		strh	r3, [r2]	@ movhi
 128:SYSTEM/usart/usart.c **** 				}		 
 363              		.loc 1 128 6 is_stmt 1 view .LVU95
 128:SYSTEM/usart/usart.c **** 				}		 
 364              		.loc 1 128 8 is_stmt 0 view .LVU96
ARM GAS  /tmp/ccX5FeAK.s 			page 10


 365 0052 C72B     		cmp	r3, #199
 366 0054 D8D9     		bls	.L19
 128:SYSTEM/usart/usart.c **** 				}		 
 367              		.loc 1 128 40 is_stmt 1 discriminator 1 view .LVU97
 128:SYSTEM/usart/usart.c **** 				}		 
 368              		.loc 1 128 52 is_stmt 0 discriminator 1 view .LVU98
 369 0056 1346     		mov	r3, r2
 370 0058 0022     		movs	r2, #0
 371 005a 1A80     		strh	r2, [r3]	@ movhi
 372              		.loc 1 134 1 discriminator 1 view .LVU99
 373 005c D4E7     		b	.L19
 374              	.LVL16:
 375              	.L25:
 123:SYSTEM/usart/usart.c **** 				else
 376              		.loc 1 123 27 is_stmt 1 discriminator 1 view .LVU100
 123:SYSTEM/usart/usart.c **** 				else
 377              		.loc 1 123 39 is_stmt 0 discriminator 1 view .LVU101
 378 005e 43F48043 		orr	r3, r3, #16384
 379 0062 024A     		ldr	r2, .L26+4
 380 0064 1380     		strh	r3, [r2]	@ movhi
 381 0066 7047     		bx	lr
 382              	.L27:
 383              		.align	2
 384              	.L26:
 385 0068 00100140 		.word	1073811456
 386 006c 00000000 		.word	.LANCHOR0
 387 0070 00000000 		.word	aRxBuffer
 388 0074 00000000 		.word	USART_RX_BUF
 389              		.cfi_endproc
 390              	.LFE139:
 392              		.section	.text.USART1_IRQHandler,"ax",%progbits
 393              		.align	1
 394              		.global	USART1_IRQHandler
 395              		.syntax unified
 396              		.thumb
 397              		.thumb_func
 398              		.fpu fpv4-sp-d16
 400              	USART1_IRQHandler:
 401              	.LFB140:
 135:SYSTEM/usart/usart.c ****  
 136:SYSTEM/usart/usart.c **** //ä¸²å£1ä¸­æ–­æœåŠ¡ç¨‹åº
 137:SYSTEM/usart/usart.c **** void USART1_IRQHandler(void)                	
 138:SYSTEM/usart/usart.c **** { 
 402              		.loc 1 138 1 is_stmt 1 view -0
 403              		.cfi_startproc
 404              		@ args = 0, pretend = 0, frame = 0
 405              		@ frame_needed = 0, uses_anonymous_args = 0
 406 0000 08B5     		push	{r3, lr}
 407              	.LCFI4:
 408              		.cfi_def_cfa_offset 8
 409              		.cfi_offset 3, -8
 410              		.cfi_offset 14, -4
 139:SYSTEM/usart/usart.c **** 	u32 timeout=0;
 411              		.loc 1 139 2 view .LVU103
 412              	.LVL17:
 140:SYSTEM/usart/usart.c **** #if SYSTEM_SUPPORT_OS	 	//ä½¿ç”¨OS
 141:SYSTEM/usart/usart.c **** 	OSIntEnter();    
ARM GAS  /tmp/ccX5FeAK.s 			page 11


 142:SYSTEM/usart/usart.c **** #endif
 143:SYSTEM/usart/usart.c **** 	
 144:SYSTEM/usart/usart.c **** 	HAL_UART_IRQHandler(&UART1_Handler);	//è°ƒç”¨HALåº“ä¸­æ–­å¤„ç†å…¬ç”¨å‡½æ•°
 413              		.loc 1 144 2 view .LVU104
 414 0002 0848     		ldr	r0, .L32
 415 0004 FFF7FEFF 		bl	HAL_UART_IRQHandler
 416              	.LVL18:
 145:SYSTEM/usart/usart.c **** 	
 146:SYSTEM/usart/usart.c **** 	timeout=0;
 417              		.loc 1 146 2 view .LVU105
 147:SYSTEM/usart/usart.c ****     while (HAL_UART_GetState(&UART1_Handler) != HAL_UART_STATE_READY)//ç­‰å¾…å°±ç»ª
 418              		.loc 1 147 5 view .LVU106
 419              	.L29:
 420              		.loc 1 147 11 view .LVU107
 421              		.loc 1 147 12 is_stmt 0 view .LVU108
 422 0008 0648     		ldr	r0, .L32
 423 000a FFF7FEFF 		bl	HAL_UART_GetState
 424              	.LVL19:
 425              		.loc 1 147 11 view .LVU109
 426 000e 2028     		cmp	r0, #32
 427 0010 FAD1     		bne	.L29
 428              	.L30:
 148:SYSTEM/usart/usart.c **** 	{
 149:SYSTEM/usart/usart.c **** 	 timeout++;////è¶…æ—¶å¤„ç†
 150:SYSTEM/usart/usart.c ****      if(timeout>HAL_MAX_DELAY) break;		
 151:SYSTEM/usart/usart.c **** 	
 152:SYSTEM/usart/usart.c **** 	}
 153:SYSTEM/usart/usart.c ****      
 154:SYSTEM/usart/usart.c **** 	timeout=0;
 155:SYSTEM/usart/usart.c **** 	while(HAL_UART_Receive_IT(&UART1_Handler, (u8 *)aRxBuffer, RXBUFFERSIZE) != HAL_OK)//ä¸€æ¬¡å¤„ç†å
 429              		.loc 1 155 7 is_stmt 1 view .LVU110
 430              		.loc 1 155 8 is_stmt 0 view .LVU111
 431 0012 0122     		movs	r2, #1
 432 0014 0449     		ldr	r1, .L32+4
 433 0016 0348     		ldr	r0, .L32
 434 0018 FFF7FEFF 		bl	HAL_UART_Receive_IT
 435              	.LVL20:
 436              		.loc 1 155 7 view .LVU112
 437 001c 0028     		cmp	r0, #0
 438 001e F8D1     		bne	.L30
 156:SYSTEM/usart/usart.c **** 	{
 157:SYSTEM/usart/usart.c **** 	 timeout++; //è¶…æ—¶å¤„ç†
 158:SYSTEM/usart/usart.c **** 	 if(timeout>HAL_MAX_DELAY) break;	
 159:SYSTEM/usart/usart.c **** 	}
 160:SYSTEM/usart/usart.c **** #if SYSTEM_SUPPORT_OS	 	//ä½¿ç”¨OS
 161:SYSTEM/usart/usart.c **** 	OSIntExit();  											 
 162:SYSTEM/usart/usart.c **** #endif
 163:SYSTEM/usart/usart.c **** } 
 439              		.loc 1 163 1 view .LVU113
 440 0020 08BD     		pop	{r3, pc}
 441              	.L33:
 442 0022 00BF     		.align	2
 443              	.L32:
 444 0024 00000000 		.word	UART1_Handler
 445 0028 00000000 		.word	aRxBuffer
 446              		.cfi_endproc
 447              	.LFE140:
ARM GAS  /tmp/ccX5FeAK.s 			page 12


 449              		.comm	UART1_Handler,64,4
 450              		.comm	aRxBuffer,1,4
 451              		.global	USART_RX_STA
 452              		.comm	USART_RX_BUF,200,4
 453              		.comm	__stdout,104,4
 454              		.section	.bss.USART_RX_STA,"aw",%nobits
 455              		.align	1
 456              		.set	.LANCHOR0,. + 0
 459              	USART_RX_STA:
 460 0000 0000     		.space	2
 461              		.text
 462              	.Letext0:
 463              		.file 2 "/opt/gcc_arm/gcc-arm-none-eabi-9-2019-q4-major/arm-none-eabi/include/machine/_default_typ
 464              		.file 3 "/opt/gcc_arm/gcc-arm-none-eabi-9-2019-q4-major/arm-none-eabi/include/sys/_stdint.h"
 465              		.file 4 "CORE/core_cm4.h"
 466              		.file 5 "USER/system_stm32f4xx.h"
 467              		.file 6 "USER/stm32f407xx.h"
 468              		.file 7 "HALLIB/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_def.h"
 469              		.file 8 "HALLIB/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_gpio.h"
 470              		.file 9 "HALLIB/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_dma.h"
 471              		.file 10 "HALLIB/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_uart.h"
 472              		.file 11 "SYSTEM/sys/sys.h"
 473              		.file 12 "/opt/gcc_arm/gcc-arm-none-eabi-9-2019-q4-major/arm-none-eabi/include/sys/lock.h"
 474              		.file 13 "/opt/gcc_arm/gcc-arm-none-eabi-9-2019-q4-major/arm-none-eabi/include/sys/_types.h"
 475              		.file 14 "/opt/gcc_arm/gcc-arm-none-eabi-9-2019-q4-major/lib/gcc/arm-none-eabi/9.2.1/include/stdde
 476              		.file 15 "/opt/gcc_arm/gcc-arm-none-eabi-9-2019-q4-major/arm-none-eabi/include/sys/reent.h"
 477              		.file 16 "/opt/gcc_arm/gcc-arm-none-eabi-9-2019-q4-major/arm-none-eabi/include/stdio.h"
 478              		.file 17 "SYSTEM/usart/usart.h"
 479              		.file 18 "HALLIB/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_cortex.h"
ARM GAS  /tmp/ccX5FeAK.s 			page 13


DEFINED SYMBOLS
                            *ABS*:0000000000000000 usart.c
     /tmp/ccX5FeAK.s:18     .text._sys_exit:0000000000000000 $t
     /tmp/ccX5FeAK.s:26     .text._sys_exit:0000000000000000 _sys_exit
     /tmp/ccX5FeAK.s:42     .text.fputc:0000000000000000 $t
     /tmp/ccX5FeAK.s:49     .text.fputc:0000000000000000 fputc
     /tmp/ccX5FeAK.s:78     .text.fputc:0000000000000014 $d
     /tmp/ccX5FeAK.s:83     .text.uart_init:0000000000000000 $t
     /tmp/ccX5FeAK.s:90     .text.uart_init:0000000000000000 uart_init
     /tmp/ccX5FeAK.s:145    .text.uart_init:000000000000002c $d
                            *COM*:0000000000000040 UART1_Handler
                            *COM*:0000000000000001 aRxBuffer
     /tmp/ccX5FeAK.s:152    .text.HAL_UART_MspInit:0000000000000000 $t
     /tmp/ccX5FeAK.s:159    .text.HAL_UART_MspInit:0000000000000000 HAL_UART_MspInit
     /tmp/ccX5FeAK.s:274    .text.HAL_UART_MspInit:000000000000007c $d
     /tmp/ccX5FeAK.s:280    .text.HAL_UART_RxCpltCallback:0000000000000000 $t
     /tmp/ccX5FeAK.s:287    .text.HAL_UART_RxCpltCallback:0000000000000000 HAL_UART_RxCpltCallback
     /tmp/ccX5FeAK.s:385    .text.HAL_UART_RxCpltCallback:0000000000000068 $d
                            *COM*:00000000000000c8 USART_RX_BUF
     /tmp/ccX5FeAK.s:393    .text.USART1_IRQHandler:0000000000000000 $t
     /tmp/ccX5FeAK.s:400    .text.USART1_IRQHandler:0000000000000000 USART1_IRQHandler
     /tmp/ccX5FeAK.s:444    .text.USART1_IRQHandler:0000000000000024 $d
     /tmp/ccX5FeAK.s:459    .bss.USART_RX_STA:0000000000000000 USART_RX_STA
                            *COM*:0000000000000068 __stdout
     /tmp/ccX5FeAK.s:455    .bss.USART_RX_STA:0000000000000000 $d

UNDEFINED SYMBOLS
HAL_UART_Init
HAL_UART_Receive_IT
HAL_GPIO_Init
HAL_NVIC_EnableIRQ
HAL_NVIC_SetPriority
HAL_UART_IRQHandler
HAL_UART_GetState
